# SAS proc sql

不完整地从 [UCLA Link](https://stats.idre.ucla.edu/sas/modules/match-merging-data-files-using-proc-sql/) 上翻译。

Horizontal Joining部分是从 [SAS Support](https://support.sas.com/resources/papers/proceedings/proceedings/sugi25/25/cc/25p109.pdf) ("PDF文档上") 翻译的。

### one-to-one merge

在这里面有两个`数据集datasets`:

* dataset dads, variables: famid(family ID), name, income
* dataset faminc, variables: famid(family ID), faminc96, faminc97, faminc98

所用的SAS代码是：

> proc sql
>
> create table dadfam1 as 
>
> select *
>
> from dads, faminc
>
> where dads.famid=faminc.famid
>
> order by das.famid;
>
> quit;

### one-to-many merge

假设有一个数据集是 `dataset dads`，另外有一个数据集是`kids`的统计，有可能*dad*有一个或者好几个*kids*，这就是`一对多`的合并用法。

### Horizontal Joining

一共有四种horizontal joining的方法，分别是inner join, left join, right join和full join. 所有这些join的方法都会自动应用Cartesian products效果：如果在两张将要合并的表格里有任意一张表格或者两张表格都有*2*项重复的matching项观察值，那么最后结果将会有*4*项观察值输出。

#### Inner Join

The inner join creates observations from data items selected from either input data set where the key values match in both talbes. 如果一个`key value`存在于两个数据集中，inner join的方式则会用两个数据集中都存在的observations来根据key value matching. 

#### Left Join

A left join slects items from all the observations in the first(left) data set regardless of their key values but only observations with matching key values from the second (right) data set. 左合并的方式，则是将第一个数据集当作左，将第二个数据集当作右，只考虑第一个数据集中的观察值，将第二个数据集中的观察值按照matching key value的方式来合并。

#### Right Join

A right join is where all the observations are selected from the second dataset and where observations do not match in the first data set the key values themseleves are assigned missing values. 

右合并的方式和左合并的方式类似，是将第二个数据集当作右，如果第二个数据集中的某一些观察值同第一个数据集中的观察值不匹配，则会被分配为空值。



